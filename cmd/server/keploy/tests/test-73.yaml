version: api.keploy.io/v1beta2
kind: Http
name: test-73
spec:
    metadata: {}
    req:
        method: POST
        proto_major: 1
        proto_minor: 1
        url: /api/regression/testcase
        header:
            Accept-Encoding: gzip
            Content-Length: "4873"
            Content-Type: application/json
            User-Agent: Go-http-client/1.1
        body: '{"captured":1678484925,"app_id":"sample-url-shortener","uri":"/url","http_req":{"method":"POST","proto_major":1,"proto_minor":1,"url":"/url","url_params":{},"header":{"Accept":["*/*"],"Content-Length":["33"],"Content-Type":["application/json"],"User-Agent":["curl/7.88.1"]},"body":"{\n  \"url\": \"https://github.com\"\n}","binary":"","form":null},"http_resp":{"status_code":200,"header":{"Content-Type":["application/json; charset=UTF-8"]},"body":"{\"ts\":1678484925093002569,\"url\":\"http://localhost:8082/4KepjkTT\"}\n","status_message":"","proto_major":0,"proto_minor":0,"binary":""},"grpc_req":{"body":"","method":""},"grpc_resp":{"body":"","error":""},"deps":[{"name":"SQL","type":"SQL_DB","meta":{"name":"SQL","operation":"Ping","type":"SQL_DB"},"data":["Cv+BBQEC/4QAAAAF/4IAAQE="]},{"name":"SQL","type":"SQL_DB","meta":{"arguments":"[{ 1 4KepjkTT}]","name":"SQL","operation":"QueryContext","query":"\"\n\t\t\tSELECT * \n\t\t\tFROM url_map\n\t\t\tWHERE id = $1\n\t\"","type":"SQL_DB"},"data":["Cv+BBQEC/4QAAAAF/4IAAQE="]},{"name":"SQL","type":"SQL_DB","meta":{"name":"SQL","operation":"QueryContext.Columns","type":"SQL_DB"},"data":["DP+FAgEC/4YAAQwAACr/hgAEAmlkDHJlZGlyZWN0X3VybApjcmVhdGVkX2F0CnVwZGF0ZWRfYXQ="]},{"name":"SQL","type":"SQL_DB","meta":{"name":"SQL","operation":"QueryContext.Next","type":"SQL_DB"},"data":["Cv+BBQEC/4QAAAAF/4IAAQE=","Cv+HBQEC/4oAAAAM/4sCAQL/jAABEAAA/5L/iAD/jVsiQmlKT1JYUnNZMGR3Y2xaR1VUMGkiLCJBeUpvZEhSd2N6b3ZMMmRwZEdoMVlpNWpiMjBpIiwiQlNJeU1ESXpMVEF6TFRFd1ZERTBPakV5T2pRMExqUXlNamd3TjFvaSIsIkJTSXlNREl6TFRBekxURXdWREU0T2pRNE9qRXdMalV6TURZd01sb2kiXQ=="]},{"name":"SQL","type":"SQL_DB","meta":{"arguments":"[{ 1 2023-03-10 18:48:45.093002569 -0300 -03 m=+2.892037919} { 2 4KepjkTT}]","name":"SQL","operation":"ExecContext","query":"\"\n\t\t\tUPDATE url_map\n\t\t\tSET updated_at = $1\n\t\t\tWHERE id = $2\n\t\"","type":"SQL_DB"},"data":["Cv+BBQEC/4QAAAAF/4IAAQE="]},{"name":"SQL","type":"SQL_DB","meta":{"arguments":"[{ 1 2023-03-10 18:48:45.093002569 -0300 -03 m=+2.892037919} { 2 4KepjkTT}]","name":"SQL","operation":"ExecContext.LastInsertId","query":"\"\n\t\t\tUPDATE url_map\n\t\t\tSET updated_at = $1\n\t\t\tWHERE id = $2\n\t\"","type":"SQL_DB"},"data":["AwQAAA==","Cv+BBQEC/4QAAAAx/4IALQFMYXN0SW5zZXJ0SWQgaXMgbm90IHN1cHBvcnRlZCBieSB0aGlzIGRyaXZlcg=="]},{"name":"SQL","type":"SQL_DB","meta":{"arguments":"[{ 1 2023-03-10 18:48:45.093002569 -0300 -03 m=+2.892037919} { 2 4KepjkTT}]","name":"SQL","operation":"ExecContext.RowsAffected","query":"\"\n\t\t\tUPDATE url_map\n\t\t\tSET updated_at = $1\n\t\t\tWHERE id = $2\n\t\"","type":"SQL_DB"},"data":["AwQAAg==","Cv+BBQEC/4QAAAAF/4IAAQE="]},{"name":"SQL","type":"SQL_DB","meta":{"name":"SQL","operation":"QueryContext.Close","type":"SQL_DB"},"data":["Cv+BBQEC/4QAAAAF/4IAAQE="]}],"test_case_path":"/home/cassio/src/echo-sql/keploy/tests","mock_path":"/home/cassio/src/echo-sql/keploy/mocks","mocks":[{"Version":"api.keploy.io/v1beta2","Kind":"SQL","Spec":{"Metadata":{"name":"SQL","operation":"Ping","type":"SQL_DB"},"Type":"error","Err":["nil"]}},{"Version":"api.keploy.io/v1beta2","Kind":"SQL","Spec":{"Metadata":{"arguments":"[{ 1 4KepjkTT}]","name":"SQL","operation":"QueryContext","query":"\"\n\t\t\tSELECT * \n\t\t\tFROM url_map\n\t\t\tWHERE id = $1\n\t\"","type":"SQL_DB"},"Type":"error","Err":["nil"]}},{"Version":"api.keploy.io/v1beta2","Kind":"SQL","Spec":{"Metadata":{"arguments":"[{ 1 2023-03-10 18:48:45.093002569 -0300 -03 m=+2.892037919} { 2 4KepjkTT}]","name":"SQL","operation":"ExecContext","query":"\"\n\t\t\tUPDATE url_map\n\t\t\tSET updated_at = $1\n\t\t\tWHERE id = $2\n\t\"","type":"SQL_DB"},"Type":"error","Err":["nil"]}},{"Version":"api.keploy.io/v1beta2","Kind":"SQL","Spec":{"Metadata":{"arguments":"[{ 1 2023-03-10 18:48:45.093002569 -0300 -03 m=+2.892037919} { 2 4KepjkTT}]","name":"SQL","operation":"ExecContext.LastInsertId","query":"\"\n\t\t\tUPDATE url_map\n\t\t\tSET updated_at = $1\n\t\t\tWHERE id = $2\n\t\"","type":"SQL_DB"},"Type":"int","Err":["LastInsertId is not supported by this driver"]}},{"Version":"api.keploy.io/v1beta2","Kind":"SQL","Spec":{"Metadata":{"arguments":"[{ 1 2023-03-10 18:48:45.093002569 -0300 -03 m=+2.892037919} { 2 4KepjkTT}]","name":"SQL","operation":"ExecContext.RowsAffected","query":"\"\n\t\t\tUPDATE url_map\n\t\t\tSET updated_at = $1\n\t\t\tWHERE id = $2\n\t\"","type":"SQL_DB"},"Type":"int","Int":1,"Err":["nil"]}},{"Version":"api.keploy.io/v1beta2","Kind":"SQL","Spec":{"Metadata":{"name":"SQL","operation":"QueryContext.Close","type":"SQL_DB"},"Type":"table","Table":{"Cols":[{"Name":"id","Type":"[]uint8"},{"Name":"redirect_url","Type":"string"},{"Name":"created_at","Type":"time.Time"},{"Name":"updated_at","Type":"time.Time"}],"Rows":["[`[52 75 101 112 106 107 84 84]` | `https://github.com` | `\"2023-03-10T14:12:44.422807Z\"` | `\"2023-03-10T18:48:10.530602Z\"` | ]"]},"Err":["nil","nil"]}}],"type":"Http"}'
        body_type: utf-8
    resp:
        status_code: 200
        header:
            Content-Type: application/json; charset=utf-8
            Vary: Origin
        body: |
            {"id":"test-1"}
        body_type: utf-8
        status_message: ""
        proto_major: 1
        proto_minor: 1
    objects:
        - type: error
          data: H4sIAAAAAAAA/wEAAP//AAAAAAAAAAA=
    mocks:
        - mock-73-0
    assertions:
        noise:
            - body.id
    created: 1678484925
